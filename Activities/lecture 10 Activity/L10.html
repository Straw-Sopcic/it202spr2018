<!DOCTYPE html>
<html>
  <head>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
      
    <link href="L10.css" rel="stylesheet">
  </head>
  <body>
      
       <!-- Navigation -->

      <nav class="navbar navbar-expand-lg navbar-dark fixed-top navbar-shrink" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top">Noki Fixers</a>
        <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger active" href="#feats">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#about">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#Reviews">Reviews</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#signUp">Sign Up</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div id="map"></div>
      
      
    <script
              src="http://code.jquery.com/jquery-3.3.1.min.js"
              integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
              crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"
            integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
            integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
            crossorigin="anonymous"></script>
      
    <script>
      var myMap, heatMap;
        
        
      function initMap() {
        myMap = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: {lat: 41.8781, lng: -87.6298},
          mapTypeId: 'satellite'
        });

        // Create a <script> tag and set the USGS URL as the source.
        var script = document.createElement('script');
          

        $.ajax({
                  url: "https://data.cityofchicago.org/resource/787j-mys9.json",
                  method: 'GET',
                }).done(function(response) {

                    eqfeed_callback(response);

                }).fail(function(err) {
                    console.log('this was a failure');
                  throw err;
                });
          
      }
        
        function toggleHeatmap() {
            heatMap.setMap(heatMap.getMap() ? null : myMap);
        }
        
        

      function changeGradient() {
        var gradient = [
          'rgba(0, 255, 255, 0)',
          'rgba(0, 255, 255, 1)',
          'rgba(0, 191, 255, 1)',
          'rgba(0, 127, 255, 1)',
          'rgba(0, 63, 255, 1)',
          'rgba(0, 0, 255, 1)',
          'rgba(0, 0, 223, 1)',
          'rgba(0, 0, 191, 1)',
          'rgba(0, 0, 159, 1)',
          'rgba(0, 0, 127, 1)',
          'rgba(63, 0, 91, 1)',
          'rgba(127, 0, 63, 1)',
          'rgba(191, 0, 31, 1)',
          'rgba(255, 0, 0, 1)'
        ]
        heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
      }

      function changeRadius() {
        heatmap.set('radius', heatmap.get('radius') ? null : 20);
      }

      function changeOpacity() {
        heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
      }
        

      function eqfeed_callback(results) {
          console.log(results);
          var heatmapData = [];
         $.each(results, function(i,v){
             if(v.hasOwnProperty("latitude") && v.hasOwnProperty("longitude")){
                    console.log(v);
                    var latLng = new google.maps.LatLng(parseFloat(v.latitude), parseFloat(v.longitude));
                    heatmapData.push(latLng);
             }
         });
        
          
        heatMap = new google.maps.visualization.HeatmapLayer({
          data: heatmapData,
          map: myMap
        });
          
//        var heatmap = new google.maps.visualization.HeatmapLayer({
//          data: heatmapData,
//          dissipating: false,
//          map: myMap
//        });
      }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC3XToRNEGfSvyk0bIbyi-GXwdjuVQGkZQ&libraries=visualization&callback=initMap">
    </script>
  </body>
</html>